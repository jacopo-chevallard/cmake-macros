# An external project for FITTER
# URL https://github.com/szaghi/FITTER
set ( FITTER_PREFIX ${CMAKE_BINARY_DIR}/dependencies )

set ( FITTER_SOURCE  ${FITTER_PREFIX}/fitter-src )
set ( FITTER_BINARY  ${FITTER_PREFIX}/fitter )
set ( FITTER_INSTALL ${CMAKE_INSTALL_PREFIX} )

set (FITTER_LIBRARY_NAME fitter)
set (FITTER_CMAKE_LIBDIR ${CMAKE_INSTALL_PREFIX}/lib)
set (FITTER_CMAKE_INCLUDEDIR ${CMAKE_INSTALL_PREFIX}/include/${FITTER_LIBRARY_NAME})

set (GIT_FITTER "https://github.com/jacopo-chevallard/FITTER.git")

if (fitter_version)

ExternalProject_Add(
  EXT_fitter
  DOWNLOAD_DIR ${FITTER_PREFIX}
  SOURCE_DIR ${FITTER_SOURCE}
  BINARY_DIR ${FITTER_BINARY}
  INSTALL_DIR ${FITTER_INSTALL}
  GIT_REPOSITORY ${GIT_FITTER}
  GIT_TAG ${fitter_version}
  CMAKE_ARGS -DCMAKE_Fortran_COMPILER=${CMAKE_Fortran_COMPILER} -DCMAKE_Fortran_FLAGS=${CMAKE_Fortran_FLAGS} -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR> -DCMAKE_NO_DEFAULT_PATH=${CMAKE_NO_DEFAULT_PATH} -DCMAKE_PARENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR} -DCMAKE_LIBRARY_TYPE=${CMAKE_LIBRARY_TYPE}
  )

else (fitter_version)

ExternalProject_Add(
  EXT_fitter
  DOWNLOAD_DIR ${FITTER_PREFIX}
  SOURCE_DIR ${FITTER_SOURCE}
  BINARY_DIR ${FITTER_BINARY}
  INSTALL_DIR ${FITTER_INSTALL}
  GIT_REPOSITORY ${GIT_FITTER}
  CMAKE_ARGS -DCMAKE_Fortran_COMPILER=${CMAKE_Fortran_COMPILER} -DCMAKE_Fortran_FLAGS=${CMAKE_Fortran_FLAGS} -DCMAKE_INSTALL_PREFIX=<INSTALL_DIR> -DCMAKE_NO_DEFAULT_PATH=${CMAKE_NO_DEFAULT_PATH} -DCMAKE_PARENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR} -DCMAKE_LIBRARY_TYPE=${CMAKE_LIBRARY_TYPE}
  )

endif (fitter_version)

set ( FITTER_INCLUDE_DIR ${FITTER_CMAKE_INCLUDEDIR} CACHE INTERNAL "FITTER include directory" )
set ( FITTER_LIBRARIES "${FITTER_CMAKE_LIBDIR}/${CMAKE_LIBRARY_PREFIX}${FITTER_LIBRARY_NAME}${CMAKE_LIBRARY_SUFFIX}" CACHE INTERNAL "FITTER library" )
